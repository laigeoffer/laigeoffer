<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微服务如何做好监控 | 🚀来个offer</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="🚀来个 offer 民间开源实战项目聚集地，助力学生党和社招党拿到一个更好的 offer 💪🏻">
    <meta name="keywords" content="🚀来个 offer 民间开源实战项目聚集地，助力学生党和社招党拿到一个更好的 offer 💪🏻,Java，JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.d7ab4724.css" as="style"><link rel="preload" href="/assets/js/app.a24138c9.js" as="script"><link rel="preload" href="/assets/js/2.31d96d71.js" as="script"><link rel="preload" href="/assets/js/12.6e39be48.js" as="script"><link rel="prefetch" href="/assets/js/10.1e97917b.js"><link rel="prefetch" href="/assets/js/11.5d182168.js"><link rel="prefetch" href="/assets/js/13.ff76f0ac.js"><link rel="prefetch" href="/assets/js/14.5c1fba79.js"><link rel="prefetch" href="/assets/js/15.08ea6f5a.js"><link rel="prefetch" href="/assets/js/16.09517c6f.js"><link rel="prefetch" href="/assets/js/17.b09cec94.js"><link rel="prefetch" href="/assets/js/18.74e9ba1f.js"><link rel="prefetch" href="/assets/js/19.d49fe542.js"><link rel="prefetch" href="/assets/js/20.945f6642.js"><link rel="prefetch" href="/assets/js/21.b2a67a2d.js"><link rel="prefetch" href="/assets/js/22.fd66b787.js"><link rel="prefetch" href="/assets/js/23.99baf32e.js"><link rel="prefetch" href="/assets/js/24.cfc91240.js"><link rel="prefetch" href="/assets/js/25.b73e37b9.js"><link rel="prefetch" href="/assets/js/26.c4bef399.js"><link rel="prefetch" href="/assets/js/27.e79ce6f3.js"><link rel="prefetch" href="/assets/js/28.68605220.js"><link rel="prefetch" href="/assets/js/29.09bbf78b.js"><link rel="prefetch" href="/assets/js/3.991d9f81.js"><link rel="prefetch" href="/assets/js/30.3a26a55c.js"><link rel="prefetch" href="/assets/js/31.e8419b1e.js"><link rel="prefetch" href="/assets/js/32.be0c2b52.js"><link rel="prefetch" href="/assets/js/33.2064d2c9.js"><link rel="prefetch" href="/assets/js/34.d5fd7572.js"><link rel="prefetch" href="/assets/js/35.0daf4aa3.js"><link rel="prefetch" href="/assets/js/36.d860fa80.js"><link rel="prefetch" href="/assets/js/37.bed13ca2.js"><link rel="prefetch" href="/assets/js/38.bd2b7e8f.js"><link rel="prefetch" href="/assets/js/39.a125ce29.js"><link rel="prefetch" href="/assets/js/4.64fe5b60.js"><link rel="prefetch" href="/assets/js/40.02dc1a45.js"><link rel="prefetch" href="/assets/js/41.4cca5fd9.js"><link rel="prefetch" href="/assets/js/42.8f9ffc4e.js"><link rel="prefetch" href="/assets/js/43.6615d897.js"><link rel="prefetch" href="/assets/js/44.a1e12778.js"><link rel="prefetch" href="/assets/js/45.706f5dea.js"><link rel="prefetch" href="/assets/js/46.611772e4.js"><link rel="prefetch" href="/assets/js/47.738ea296.js"><link rel="prefetch" href="/assets/js/48.953c01ee.js"><link rel="prefetch" href="/assets/js/49.eba4ed5c.js"><link rel="prefetch" href="/assets/js/5.783e9e4e.js"><link rel="prefetch" href="/assets/js/50.092d52db.js"><link rel="prefetch" href="/assets/js/51.a31c7a30.js"><link rel="prefetch" href="/assets/js/52.6b3588a4.js"><link rel="prefetch" href="/assets/js/53.1e92beed.js"><link rel="prefetch" href="/assets/js/54.b3ec8f96.js"><link rel="prefetch" href="/assets/js/55.46c487f1.js"><link rel="prefetch" href="/assets/js/56.b077308b.js"><link rel="prefetch" href="/assets/js/57.042976a7.js"><link rel="prefetch" href="/assets/js/58.9a4c2b34.js"><link rel="prefetch" href="/assets/js/59.687a076c.js"><link rel="prefetch" href="/assets/js/6.06b02aa2.js"><link rel="prefetch" href="/assets/js/60.d0736399.js"><link rel="prefetch" href="/assets/js/61.966a8c9b.js"><link rel="prefetch" href="/assets/js/62.c992eeb0.js"><link rel="prefetch" href="/assets/js/63.691b3875.js"><link rel="prefetch" href="/assets/js/64.e8897d50.js"><link rel="prefetch" href="/assets/js/7.4be6ddfd.js"><link rel="prefetch" href="/assets/js/8.036c8ca4.js"><link rel="prefetch" href="/assets/js/9.a1f612ec.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d7ab4724.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="🚀来个offer" class="logo"> <span class="site-name can-hide">🚀来个offer</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端技术" class="dropdown-title"><a href="/technology/mq/" class="link-title">后端技术</a> <span class="title" style="display:none;">后端技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology/mq/" class="nav-link">消息队列</a></li><li class="dropdown-item"><!----> <a href="/pages/weifuwu/" class="nav-link">微服务</a></li><li class="dropdown-item"><!----> <a href="/pages/yunyuansheng/" class="nav-link">云原生</a></li><li class="dropdown-item"><!----> <a href="/pages/aigc/" class="nav-link">大模型&amp;AIGC</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥实战项目" class="dropdown-title"><a href="/project/laigeoffer/pmhub/about/" class="link-title">🔥实战项目</a> <span class="title" style="display:none;">🔥实战项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>校招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/laigeoffer/pmhub/about/" class="nav-link">PmHub（智能项目管理平台）</a></li></ul></li><li class="dropdown-item"><h4>社招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/laigeoffer/AutoCodeFlow/about/" class="nav-link">AutoCodeFlow（自动编码系统）</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线体验" class="dropdown-title"><!----> <span class="title" style="display:;">在线体验</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>校招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://pmhub.laigeoffer.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PmHub（智能项目管理平台）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>社招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://pmhub.laigeoffer.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AutoCodeFlow（自动编码系统）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/laigeoffer/studygroupabout/" class="nav-link">🌈加入学习群</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="珍藏资源" class="dropdown-title"><!----> <span class="title" style="display:;">珍藏资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resource/pdftoc/" class="nav-link">⬇️PDF下载</a></li><li class="dropdown-item"><!----> <a href="/pages/pojieheji/" class="nav-link">🔓破解合集</a></li></ul></div></div> <a href="https://github.com/laigeoffer" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端技术" class="dropdown-title"><a href="/technology/mq/" class="link-title">后端技术</a> <span class="title" style="display:none;">后端技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology/mq/" class="nav-link">消息队列</a></li><li class="dropdown-item"><!----> <a href="/pages/weifuwu/" class="nav-link">微服务</a></li><li class="dropdown-item"><!----> <a href="/pages/yunyuansheng/" class="nav-link">云原生</a></li><li class="dropdown-item"><!----> <a href="/pages/aigc/" class="nav-link">大模型&amp;AIGC</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥实战项目" class="dropdown-title"><a href="/project/laigeoffer/pmhub/about/" class="link-title">🔥实战项目</a> <span class="title" style="display:none;">🔥实战项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>校招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/laigeoffer/pmhub/about/" class="nav-link">PmHub（智能项目管理平台）</a></li></ul></li><li class="dropdown-item"><h4>社招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/laigeoffer/AutoCodeFlow/about/" class="nav-link">AutoCodeFlow（自动编码系统）</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线体验" class="dropdown-title"><!----> <span class="title" style="display:;">在线体验</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>校招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://pmhub.laigeoffer.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PmHub（智能项目管理平台）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>社招实战项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://pmhub.laigeoffer.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AutoCodeFlow（自动编码系统）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/laigeoffer/studygroupabout/" class="nav-link">🌈加入学习群</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="珍藏资源" class="dropdown-title"><!----> <span class="title" style="display:;">珍藏资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resource/pdftoc/" class="nav-link">⬇️PDF下载</a></li><li class="dropdown-item"><!----> <a href="/pages/pojieheji/" class="nav-link">🔓破解合集</a></li></ul></div></div> <a href="https://github.com/laigeoffer" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>消息队列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technology/mq/" class="sidebar-link">springcloud</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>微服务</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/weifuwu/" class="sidebar-link">微服务之SpringCloud</a></li><li><a href="/pages/0cc3cb/" class="sidebar-link">微服务中的鉴权怎么做？</a></li><li><a href="/pages/be8758/" aria-current="page" class="active sidebar-link">微服务如何做好监控</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/be8758/#服务监控概念" class="sidebar-link">服务监控概念</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#服务常用技术栈" class="sidebar-link">服务常用技术栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/be8758/#_1、spring-boot-actuator" class="sidebar-link">1、Spring Boot Actuator</a></li><li class="sidebar-sub-header level3"><a href="/pages/be8758/#_2、micrometer" class="sidebar-link">2、Micrometer</a></li><li class="sidebar-sub-header level3"><a href="/pages/be8758/#_3、dropwizard-metrics" class="sidebar-link">3、Dropwizard Metrics</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#新建监控中心微服务" class="sidebar-link">新建监控中心微服务</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#添加依赖" class="sidebar-link">添加依赖</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#添加配置" class="sidebar-link">添加配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#web-ui-页面" class="sidebar-link">web ui 页面</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#登录认证" class="sidebar-link">登录认证</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#实时日志" class="sidebar-link">实时日志</a></li><li class="sidebar-sub-header level2"><a href="/pages/be8758/#监控通知" class="sidebar-link">监控通知</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>云原生</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/yunyuansheng/" class="sidebar-link">nodejs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大模型&amp;AIGC</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/aigc/" class="sidebar-link">博客搭建</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF" title="分类" data-v-06225672>后端技术</a></li><li data-v-06225672><a href="/categories/?category=%E5%BE%AE%E6%9C%8D%E5%8A%A1" title="分类" data-v-06225672>微服务</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/freestylefly" target="_blank" title="作者" class="beLink" data-v-06225672>苍何</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-05-21</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><!---->微服务如何做好监控<!----></h1>  <div class="theme-vdoing-content content__default"><p>大家好，我是苍何。</p> <p>在脉脉上看到这条帖子，说阿里 P8 因为上面 P9 斗争失败走人，以<strong>超龄 35 被裁</strong>，Boss 上找工作半年，到现在还处于<strong>失业</strong>中。</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/29495295/1715840704604-e1500b04-5e7d-420e-83be-3b6c730e32c9.jpeg#averageHue=%23e8decb&amp;clientId=u752d3eff-3364-4&amp;from=ui&amp;id=u67763431&amp;originHeight=944&amp;originWidth=1179&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=157639&amp;status=done&amp;style=none&amp;taskId=u9c724275-acef-43d8-9dd9-61c8f4a5e2f&amp;title=%E8%84%89%E8%84%89%E4%B8%8A%E6%88%AA%E5%9B%BE" alt="脉脉上截图" title="脉脉上截图"></p> <p>看了下沟通记录， 沟通了 1000 多次，但<strong>没有一个</strong>邀请投递简历的，大受震撼。因为早年在阿里待过，所以对阿里 P8 这个 title 的含金量还是知道的，先不说是很高 P，但能升到 P8 这个段位的，多少还是有点能力的。</p> <p>当然了无论是做 PPT 的能力还是处理问题的能力，最起码都属于一种区别于普通人的能力嘛。按理说这个级别出来工作应该是随便找，不至于找半年没找到一份工作。</p> <p>于是有网友认为，有点儿扯，说到了 P8 这个级别不应该会因为上级的派系斗争被搞走，而且对其艰难找工作不大相信。</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/png/29495295/1715841221594-5a3e21ce-33ed-4bd7-ab1e-52bda92544e5.png#averageHue=%23f8f8f7&amp;clientId=u752d3eff-3364-4&amp;from=ui&amp;id=ua4ca75c0&amp;originHeight=1066&amp;originWidth=1170&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=225235&amp;status=done&amp;style=none&amp;taskId=u5d019284-9b20-4a93-8f43-07f94c8c0b4&amp;title=%E7%BD%91%E5%8F%8B%E8%AF%B4P8%E6%89%BE%E4%B8%8D%E5%88%B0%E5%B7%A5%E4%BD%9C%E6%9C%89%E7%82%B9%E6%89%AF" alt="网友说P8找不到工作有点扯" title="网友说P8找不到工作有点扯"></p> <p>但也有人从这件事上分析原因觉得，因为这个 P8 处于 35 岁年龄高危人群，是个传话筒，薪酬高，竞争力有待考证。</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/29495295/1715841452421-e4f0fe76-ddaf-4bbb-b31f-97346292eb15.jpeg#averageHue=%23fafafa&amp;clientId=u752d3eff-3364-4&amp;from=ui&amp;id=u3b65dcc7&amp;originHeight=620&amp;originWidth=1170&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=63412&amp;status=done&amp;style=none&amp;taskId=uee91cc36-ec13-4e8e-8aa5-e7965af4091&amp;title=%E6%9C%89%E4%BA%BA%E8%AF%B4P8%E5%A4%84%E4%BA%8E%E9%AB%98%E5%8D%B1%E4%BA%BA%E7%BE%A4" alt="有人说P8处于高危人群" title="有人说P8处于高危人群"></p> <p>抛去别的不说，我觉得不至于没有一个公司给他发简历投递邀请，但这件事我觉得从侧面反映出一个问题，那就是<strong>以前互联网那套玩法行不通了</strong>，即使在大厂，该被裁还是得被裁，出来后，能接住这么高的工资的公司除了另外一个大厂基本没有，小公司和国企是很难给到他们原先在大厂工资的。</p> <p>我跟很多大厂的朋友经常聊天，谈起裁员这个话题，虽说他们对现在的环境愤愤不平，但又无能为力。但我经常和他们分享我自己的观点：不管在哪儿，<strong>一定要有自己的一点小生意</strong>。</p> <p>在大厂可能负责的是一个大平台里面的一小处螺丝，然后就自以为创造了很多的价值，加班加点的 coding，最后甚至连平台到底吸引什么样的用户？市场在哪里？ARR 表现如何？实际带来什么样的价值都没搞明白就稀里糊涂的被裁了。</p> <p>建立自己的小生意，业余时间做一点点<strong>小而美</strong>的事情，不仅仅限于 coding，从市场、营销、产品等多角度来思考这个小生意创造的价值。</p> <p>我也一直在践行这个理念，包括最近业余时间投身的开源项目，也是属于<strong>小而美</strong>的事情。而且我也会持续做这方面的分享，<strong>build in public</strong>，一起成长。</p> <p>今天分享的是微服务改造过程中，<strong>监控中心</strong>的搭建要领和流程。</p> <h1 id="什么是服务监控"><a href="#什么是服务监控" class="header-anchor">#</a> 什么是服务监控</h1> <h2 id="服务监控概念"><a href="#服务监控概念" class="header-anchor">#</a> 服务监控概念</h2> <p>在说概念前，其实可以借助一下生活中的一个例子来理解：</p> <p>想象你是一位餐馆经理。你的餐馆里有很多员工在不同岗位工作：厨师在做饭，服务员在端菜，收银员在结账。如果你想让餐馆顺利运营，你需要知道每个员工的工作状态。如果某个岗位出现问题，比如厨师突然生病了，你需要及时知道并做出调整，以确保餐馆正常运作，不会影响顾客体验。</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/webp/29495295/1715909130250-e93ef4e3-103b-48cd-b735-22435caf56eb.webp#averageHue=%237fa8aa&amp;clientId=ud7e406f0-a820-4&amp;from=drop&amp;id=ucaf6141f&amp;originHeight=1024&amp;originWidth=1792&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=573228&amp;status=done&amp;style=none&amp;taskId=u8ae8fbdd-902b-45aa-95d7-b0859cee58f&amp;title=%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E7%A4%BA%E4%BE%8B%E5%9B%BE" alt="服务监控示例图" title="服务监控示例图"></p> <p>服务监控就像是餐馆经理对员工工作状态的监视。它包括以下几个方面：</p> <ol><li><strong>系统应用状态：</strong> 就像经理需要知道每个员工在做什么，服务监控需要知道每个系统应用在做什么，是否正常运行。</li> <li><strong>内存和线程：</strong> 就像餐馆需要确保有足够的食材和员工，系统也需要足够的内存和线程来处理任务。监控这些可以确保系统不会因为资源不足而崩溃。</li> <li><strong>堆栈：</strong> 就像经理需要知道每道菜的制作流程，监控堆栈信息可以帮助了解程序的执行流程，找出哪里出了问题。</li> <li><strong>日志：</strong> 就像经理需要记录每天的销售和反馈，系统日志记录了所有的操作和错误信息，方便追踪和排查问题。</li></ol> <p>服务监控的主要目的是在问题发生或即将发生时，能<strong>准确</strong>、<strong>快速</strong>地发现问题，从而<strong>减小影响范围</strong>。就像餐馆经理能及时发现并处理员工的问题，以避免影响整个餐馆的运营。</p> <p>服务监控在<strong>微服务改造</strong>过程中的重要性不言而喻，没有强大的监控能力，改造成微服务架构后，就无法掌控各个不同服务的情况，在遇到调用失败时，如果不能快速发现系统的问题，对于业务来说就是一场灾难。</p> <h2 id="服务常用技术栈"><a href="#服务常用技术栈" class="header-anchor">#</a> 服务常用技术栈</h2> <h3 id="_1、spring-boot-actuator"><a href="#_1、spring-boot-actuator" class="header-anchor">#</a> 1、Spring Boot Actuator</h3> <p>Spring Boot Actuator 提供了一系列内置的端点，用于监控和管理 Spring Boot 应用程序。它可以暴露健康检查、应用信息、环境变量、JVM 指标、HTTP 请求追踪等。</p> <p>适用于使用 Spring Boot 构建的微服务应用，集成简单，功能强大。</p> <p>以下是一些常见端点：</p> <table><thead><tr><th>地址</th> <th>描述</th></tr></thead> <tbody><tr><td>/beans</td> <td>显示所有的Spring bean列表</td></tr> <tr><td>/caches</td> <td>显示所有的缓存相关信息</td></tr> <tr><td>/scheduledtasks</td> <td>显示所有的定时任务相关信息</td></tr> <tr><td>/loggers</td> <td>显示所有的日志相关信息</td></tr> <tr><td>/configprops</td> <td>显示所有的配置信息</td></tr> <tr><td>/env</td> <td>显示所有的环境变量信息</td></tr> <tr><td>/mappings</td> <td>显示所有控制器相关信息</td></tr> <tr><td>/info</td> <td>显示自定义用户信息配置</td></tr> <tr><td>/metrics</td> <td>显示应用指标相关信息</td></tr> <tr><td>/health</td> <td>显示健康检查状态信息，up表示成功 down表示失败</td></tr> <tr><td>/threaddump</td> <td>显示程序线程的信息</td></tr></tbody></table> <h3 id="_2、micrometer"><a href="#_2、micrometer" class="header-anchor">#</a> 2、Micrometer</h3> <p>Micrometer 是一个用于 JVM 应用程序的应用指标度量库。它提供与多种监控系统的集成，如 Prometheus、Graphite、JMX、New Relic、Datadog 等。需要在 Spring Boot 之外的 JVM 应用中进行指标监控，或者需要集成到多种监控系统中。优势是其有统一的 API，便于扩展和集成。</p> <h3 id="_3、dropwizard-metrics"><a href="#_3、dropwizard-metrics" class="header-anchor">#</a> 3、Dropwizard Metrics</h3> <p>Dropwizard Metrics 提供了一组用于度量 JVM 应用程序性能的工具，包括计数器、计时器、仪表等。它可以与多种后端系统集成，如 Graphite、Ganglia、Prometheus 等。需要在非 Spring Boot 应用中实现详细的性能度量。优势：轻量级，易于集成，功能全面。</p> <h1 id="如何做好监控"><a href="#如何做好监控" class="header-anchor">#</a> 如何做好监控</h1> <p>我本次使用的是利用 Spring Boot Actuator 配合 Admin-Ui，整合 Nacos，来做的各个微服务的系统监控。以下是具体的步骤：</p> <h2 id="新建监控中心微服务"><a href="#新建监控中心微服务" class="header-anchor">#</a> 新建监控中心微服务</h2> <p>监控中心一定是单独部署的一个微服务，不要和其他微服务做藕和，其中建微服务系统其实就是 4 步：</p> <ul><li>建 Module</li> <li>改 pom</li> <li>加 yml</li> <li>启动类启动</li></ul> <p>在 idea 中右键项目新建 Module 命名 monitor，建监控中心微服务：</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/png/29495295/1715910006071-9b4c2f97-f1f0-4feb-aaa5-d31e26a75925.png#averageHue=%23414646&amp;clientId=ud7e406f0-a820-4&amp;from=paste&amp;height=367&amp;id=ufd68dd4f&amp;originHeight=733&amp;originWidth=912&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=162675&amp;status=done&amp;style=none&amp;taskId=u95f938ab-1c5d-48f3-9429-11a4d5040df&amp;title=%E7%9B%91%E6%8E%A7%E4%B8%AD%E5%BF%83%20Module&amp;width=456" alt="监控中心 Module" title="监控中心 Module"></p> <p>一个微服务就建好了，接下来需要添加必要的依赖和配置。</p> <h2 id="添加依赖"><a href="#添加依赖" class="header-anchor">#</a> 添加依赖</h2> <p>因为需要整合 Nacos，以及配合 web ui 和登录认证，故引入以下 jar：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- SpringBoot Admin --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>de.codecentric<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-admin-starter-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${spring-boot-admin.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- SpringCloud Alibaba Nacos --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- SpringCloud Alibaba Nacos Config --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- Spring Cloud Config Client，用于配置的动态刷新 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-bootstrap<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- SpringCloud Alibaba Sentinel --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- SpringBoot Web --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- Spring Security --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="添加配置"><a href="#添加配置" class="header-anchor">#</a> 添加配置</h2> <p>配置有独立服务配置和 Nacos 共享配置以及微服务 Nacos 配置，三份配置共同作用于微服务系统，其中优先级顺序是Nacos 共享配置&gt;微服务 Nacos 配置&gt;独立服务配置</p> <p>对于每个微服务都需要的配置放在共享配置中，本次这部分不做改动，另外是微服务的 Nacos 配置和本地配置如下：</p> <p>本地配置：bootstrap.yml</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># Tomcat</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> 端口

<span class="token comment"># Spring</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span> 
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token comment"># 应用名称</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> monitor
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token comment"># 环境配置</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token comment"># 服务注册地址</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span>端口
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token comment"># 配置中心地址</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span>端口
        <span class="token comment"># 配置文件格式</span>
        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yml
        <span class="token comment"># 共享配置</span>
        <span class="token key atrule">shared-configs</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> application<span class="token punctuation">-</span>$<span class="token punctuation">{</span>spring.profiles.active<span class="token punctuation">}</span>.$<span class="token punctuation">{</span>spring.cloud.nacos.config.file<span class="token punctuation">-</span>extension<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>Nacos 配置：monitor-dev.yml</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># spring</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">security</span><span class="token punctuation">:</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> web页面中的用户名
      <span class="token key atrule">password</span><span class="token punctuation">:</span> 密码
  <span class="token key atrule">boot</span><span class="token punctuation">:</span>
    <span class="token key atrule">admin</span><span class="token punctuation">:</span>
      <span class="token key atrule">ui</span><span class="token punctuation">:</span>
        <span class="token key atrule">title</span><span class="token punctuation">:</span> 服务状态监控
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>通过以上步骤直接访问微服务地址即可直接访问，这里监控中心的微服务没有直接走网关，而是直接暴露出来，因为其内部自己做了鉴权处理，就不走网关通用鉴权了。</p> <h1 id="监控有用功能"><a href="#监控有用功能" class="header-anchor">#</a> 监控有用功能</h1> <h2 id="web-ui-页面"><a href="#web-ui-页面" class="header-anchor">#</a> web ui 页面</h2> <p>在 UI 页面上可以清晰的看出服务系统的情况，方便直观，而且耦合性比较低。以下是我项目的监控情况：</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/png/29495295/1715910693827-106b9d6f-9876-4ee2-b98d-ee7ac874808f.png#averageHue=%233a4f46&amp;clientId=ud7e406f0-a820-4&amp;from=paste&amp;height=454&amp;id=uce6657fd&amp;originHeight=908&amp;originWidth=1907&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=187467&amp;status=done&amp;style=none&amp;taskId=ua151b768-a780-496c-80cf-73fac06498f&amp;title=%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E5%BA%94%E7%94%A8%E5%A2%99&amp;width=953.5" alt="服务监控应用墙" title="服务监控应用墙"></p> <p>点进去每一个微服务可看到具体监控信息：</p> <p><img src="https://cdn.nlark.com/yuque/0/2024/png/29495295/1715910746564-62d4dee6-2402-4eb3-b8d1-d8d235d09d62.png#averageHue=%23e9e9e9&amp;clientId=ud7e406f0-a820-4&amp;from=paste&amp;height=486&amp;id=ud81378ee&amp;originHeight=971&amp;originWidth=1922&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=143994&amp;status=done&amp;style=none&amp;taskId=u0e006aae-6a66-44ac-b973-b77e6753858&amp;title=%E5%8D%95%E4%B8%AA%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E8%AF%A6%E6%83%85&amp;width=961" alt="单个微服务监控详情" title="单个微服务监控详情"></p> <h2 id="登录认证"><a href="#登录认证" class="header-anchor">#</a> 登录认证</h2> <p>配合 admin，加上 Spring security 权限控制，我们只需要按照步骤配置一下账户和密码即可。权限配置类：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 监控权限配置
 * 
 * @author ruoyi
 */</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfigurer</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> adminContextPath<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">WebSecurityConfigurer</span><span class="token punctuation">(</span><span class="token class-name">AdminServerProperties</span> adminServerProperties<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>adminContextPath <span class="token operator">=</span> adminServerProperties<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SecurityFilterChain</span> <span class="token function">filterChain</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> httpSecurity<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">SavedRequestAwareAuthenticationSuccessHandler</span> successHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SavedRequestAwareAuthenticationSuccessHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        successHandler<span class="token punctuation">.</span><span class="token function">setTargetUrlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;redirectTo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        successHandler<span class="token punctuation">.</span><span class="token function">setDefaultTargetUrl</span><span class="token punctuation">(</span>adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> httpSecurity
        <span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frameOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span>adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/assets/**&quot;</span>
                     <span class="token punctuation">,</span> adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/login&quot;</span>
                     <span class="token punctuation">,</span> adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/actuator/**&quot;</span>
                     <span class="token punctuation">,</span> adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/instances/**&quot;</span>
                    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span>adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">successHandler</span><span class="token punctuation">(</span>successHandler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logoutUrl</span><span class="token punctuation">(</span>adminContextPath <span class="token operator">+</span> <span class="token string">&quot;/logout&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">httpBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>这样，每次登录 UI 页面就需要进行账号密码登录鉴权，其走的不是网关统一鉴权所以需要单独配置。</p> <h2 id="实时日志"><a href="#实时日志" class="header-anchor">#</a> 实时日志</h2> <p>Spring Boot Admin提供了基于Web页面的方式实时查看服务输出的本地日志，前提是服务中配置了logging.file.name。</p> <p>需要在单个微服务的 bootstrap.yml配置logging.file.name配置：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">file</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> logs/$<span class="token punctuation">{</span>spring.application.name<span class="token punctuation">}</span>/info.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29495295/1715911055717-59bdbfb6-ef55-4f36-8fe2-deaeddcb4e5e.png#averageHue=%23d5d5d5&amp;clientId=ud7e406f0-a820-4&amp;from=paste&amp;height=434&amp;id=u281d5467&amp;originHeight=868&amp;originWidth=1888&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=true&amp;size=431504&amp;status=done&amp;style=none&amp;taskId=ud4c81313-7bd0-4b3d-b97f-1569370c45f&amp;title=%E5%AE%9E%E6%97%B6%E6%97%A5%E5%BF%97%E6%9F%A5%E8%AF%A2&amp;width=944" alt="实时日志查询" title="实时日志查询"></p> <p>对于单独差某个微服务信息来说，实时日志还是挺方便的。</p> <h2 id="监控通知"><a href="#监控通知" class="header-anchor">#</a> 监控通知</h2> <p>当微服务监控检查没通过，或者服务上线、离线或者服务发生未知异常，希望发送通知到制定的人，就可以直接通过如下配置即可：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @author canghe
 * @description 通知发送配置
 * @create 2024-05-16-17:32
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PmHubStatusChangeNotifier</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractStatusChangeNotifier</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">PmHubStatusChangeNotifier</span><span class="token punctuation">(</span><span class="token class-name">InstanceRepository</span> repository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>repository<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">doNotify</span><span class="token punctuation">(</span><span class="token class-name">InstanceEvent</span> event<span class="token punctuation">,</span>
                                  <span class="token class-name"><span class="token namespace">de<span class="token punctuation">.</span>codecentric<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>server<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span>Instance</span> instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">fromRunnable</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token keyword">instanceof</span> <span class="token class-name">InstanceStatusChangedEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> status <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">InstanceStatusChangedEvent</span><span class="token punctuation">)</span> event<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatusInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 健康检查没通过</span>
                    <span class="token keyword">case</span> <span class="token string">&quot;DOWN&quot;</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;发送 健康检查没通过 的通知！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token comment">// 服务离线</span>
                    <span class="token keyword">case</span> <span class="token string">&quot;OFFLINE&quot;</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;发送 服务离线 的通知！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token comment">// 服务上线</span>
                    <span class="token keyword">case</span> <span class="token string">&quot;UP&quot;</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;发送 服务上线 的通知！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token comment">// 服务未知异常</span>
                    <span class="token keyword">case</span> <span class="token string">&quot;UNKNOWN&quot;</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;发送 服务未知异常 的通知！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">default</span><span class="token operator">:</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>通过以上步骤，微服务系统中的服务监控就简单集成了，对于监控中的业务逻辑，比如通知消息等就可以自己去实现他。</p> <p>以上是今天的分享，感谢您的阅读！</p></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/05/21, 08:38:17</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/0cc3cb/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">微服务中的鉴权怎么做？</div></a> <a href="/pages/yunyuansheng/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">nodejs</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/0cc3cb/" class="prev">微服务中的鉴权怎么做？</a></span> <span class="next"><a href="/pages/yunyuansheng/">nodejs</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="canghe0818@gmain.con" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/laigeoffer" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2024
    <span><a href="https://github.com/laigeoffer" target="_blank">laigeoffer</a> | <a href="https://github.com/laigeoffer" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a24138c9.js" defer></script><script src="/assets/js/2.31d96d71.js" defer></script><script src="/assets/js/12.6e39be48.js" defer></script>
  </body>
</html>
