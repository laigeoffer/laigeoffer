(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{325:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è‹ä½•å‘€ã€‚")]),s._v(" "),t("p",[s._v("ç°åœ¨å‡ºå»æ‰¾å·¥ä½œï¼Œç®€å†ä¸Šä¸å†™ä¸Šå¾®æœåŠ¡çš„æŠ€æœ¯ï¼Œä»¿ä½›è‡ªå·±è·Ÿä¸ä¸Šæ—¶ä»£äº†ï¼Œé¢è¯•å®˜æ›´æ˜¯å–œæ¬¢ç›¯ç€"),t("strong",[s._v("å¾®æœåŠ¡é¡¹ç›®")]),s._v("æ¥æé—®ã€‚")]),s._v(" "),t("p",[s._v("ä½†å…¶å®è™½è¯´å¾®æœåŠ¡æ˜¯ä¸»æµï¼Œéšç€äº‘åŸç”Ÿæ¶æ„çš„å‘å±•ï¼Œå¾®æœåŠ¡ä¹Ÿæ˜¯è¶‹åŠ¿ï¼Œä½†å¾ˆå¤šå…¬å¸ç‰¹åˆ«æ˜¯ä¸­å°å…¬å¸çš„ä¸­å°ä¸šåŠ¡ï¼Œæ ¹æœ¬ç”¨ä¸ä¸Šå¾®æœåŠ¡ï¼Œä½ è¯´ä¸€ä¸ªç®€å•çš„å†…éƒ¨ç®¡ç†ç³»ç»Ÿï¼Œéå¾—ä¸Šå¾®æœåŠ¡ï¼Œæœ‰ç‚¹ä¸ºäº†å¾®æœåŠ¡è€Œå¾®æœåŠ¡çš„æ„Ÿè§‰äº†ğŸ˜‚ã€‚")]),s._v(" "),t("p",[s._v("ä¸ºäº†å¤§å®¶èƒ½æœ‰ä¸ªå¯æ”¾åœ¨ç®€å†ä¸Šã€Œ"),t("strong",[s._v("å¹é€¼")]),s._v("ã€çš„å¾®æœåŠ¡é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨å•ä½“ç‰ˆæœ¬çš„åŸºç¡€ä¸Šåˆå¢åŠ äº†å¾®æœåŠ¡ç‰ˆæœ¬ï¼Œå¹¶åœ¨æ¥ä¸‹æ¥çš„ä¸€æ®µæ—¶é—´å†…ï¼ŒæŒç»­åˆ†äº«"),t("strong",[s._v("å•ä½“åº”ç”¨å¾®æœåŠ¡åŒ–")]),s._v("çš„ç»éªŒã€‚")]),s._v(" "),t("p",[s._v("ä»Šå¤©åˆ†äº«çš„æ˜¯ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œ"),t("strong",[s._v("å¦‚ä½•åšå¥½é‰´æƒ")]),s._v("ã€‚")]),s._v(" "),t("h1",{attrs:{id:"å¾®æœåŠ¡æ¶æ„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¾®æœåŠ¡æ¶æ„"}},[s._v("#")]),s._v(" å¾®æœåŠ¡æ¶æ„")]),s._v(" "),t("p",[s._v("å¾®æœåŠ¡ç®€è€Œè¨€ä¹‹å°±æ˜¯å•ä¸ªç‹¬ç«‹çš„æœåŠ¡ï¼Œå¯ä»¥"),t("strong",[s._v("ç‹¬ç«‹å¼€å‘")]),s._v("ã€"),t("strong",[s._v("éƒ¨ç½²")]),s._v("å’Œ"),t("strong",[s._v("ç»´æŠ¤")]),s._v("ã€‚è€Œå¾®æœåŠ¡æ¶æ„æ˜¯æŒ‡çš„"),t("strong",[s._v("å¤šä¸ªå¾®æœåŠ¡èšåˆèµ·æ¥çš„ç³»ç»Ÿ")]),s._v("ï¼Œè¿™ä¸ªç³»ç»Ÿæ¶µç›–å¤šä¸ªå¾®æœåŠ¡ï¼ŒæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„é€šè®¯ã€æœåŠ¡ç›‘æ§ã€æœåŠ¡ç†”æ–­é™çº§ã€æœåŠ¡æ³¨å†Œã€åˆ†å¸ƒå¼é…ç½®ã€åˆ†å¸ƒå¼äº‹åŠ¡ç­‰å„ç§è§£å†³æ–¹æ¡ˆèšåˆè€Œæˆçš„æ¶æ„ä½“ç³»ã€‚")]),s._v(" "),t("p",[s._v("å¾®æœåŠ¡æ¶æ„æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("æé«˜å¼€å‘æ•ˆç‡")]),s._v("ï¼šå›¢é˜Ÿå¯ä»¥å¹¶è¡Œå¼€å‘ä¸åŒçš„å¾®æœåŠ¡ï¼Œå‡å°‘äº†å¼€å‘å’Œå‘å¸ƒçš„æ—¶é—´ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å¢å¼ºå¯ç»´æŠ¤æ€§")]),s._v("ï¼šå°è€Œä¸“æ³¨çš„ä»£ç åº“æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ï¼Œé™ä½äº†æŠ€æœ¯å€ºåŠ¡ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("çµæ´»çš„æŠ€æœ¯é€‰å‹")]),s._v("ï¼šä¸åŒçš„å¾®æœåŠ¡å¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨æœ€åˆé€‚çš„æŠ€æœ¯æ ˆï¼Œè€Œæ— éœ€åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ä¿æŒä¸€è‡´ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æŒç»­äº¤ä»˜å’Œéƒ¨ç½²")]),s._v("ï¼šå¾®æœåŠ¡æ¶æ„æ”¯æŒæŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ï¼ˆCI/CDï¼‰ï¼Œä½¿å¾—æ–°åŠŸèƒ½å’Œä¿®å¤èƒ½å¤Ÿå¿«é€Ÿä¸Šçº¿ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æ›´å¥½çš„æ•…éšœéš”ç¦»")]),s._v("ï¼šä¸€ä¸ªå¾®æœåŠ¡çš„æ•…éšœä¸ä¼šå½±å“å…¶ä»–å¾®æœåŠ¡çš„æ­£å¸¸è¿è¡Œï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯é æ€§ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æŒ‰éœ€æ‰©å±•")]),s._v("ï¼šå¯ä»¥ç‹¬ç«‹åœ°æ‰©å±•éœ€è¦é«˜è´Ÿè½½å¤„ç†çš„å¾®æœåŠ¡ï¼Œä¼˜åŒ–èµ„æºä½¿ç”¨å’Œæˆæœ¬ã€‚")])]),s._v(" "),t("h1",{attrs:{id:"é‰´æƒåŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é‰´æƒåŸºç¡€"}},[s._v("#")]),s._v(" é‰´æƒåŸºç¡€")]),s._v(" "),t("p",[s._v("é‰´æƒé¡¾åæ€ä¹‰å°±æ˜¯éœ€è¦è¿›è¡Œ"),t("strong",[s._v("æƒé™è®¤è¯å’Œæˆæƒæ§åˆ¶")]),s._v("ï¼Œä½ å†™å¥½çš„ç³»ç»Ÿä¸å¸Œæœ›è°éƒ½å¯ä»¥è®¿é—®å§ï¼Ÿä½ å†™çš„ç‰›é€¼çš„æ¥å£ä¹Ÿä¸å¸Œæœ›å“ªä¸ªäººéƒ½å¯ä»¥æ¥è¹­ä¸€ä¸‹è®¿é—®å§ï¼Ÿé‚£å°±éœ€è¦è®¤è¯å’Œæˆæƒã€‚")]),s._v(" "),t("p",[s._v("ä¸“ä¸šåšè¿™å—çš„æœ‰ Spring Security å’Œ Shiro è¿™ä¸¤å“¥ä»¬ï¼Œå½“ç„¶è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ¡†æ¶ä¹Ÿæ˜¯å¯ä»¥åšçš„ï¼Œä½†æ— éæ ¸å¿ƒéƒ½åœ¨åšä¸¤ä»¶äº‹ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è®¤è¯")])]),s._v(" "),t("li",[t("strong",[s._v("æˆæƒ")])])]),s._v(" "),t("p",[s._v("è®¤è¯ï¼Œè¯´ç™½äº†å°±æ˜¯ç™»å½•ï¼Œä¼ ç»Ÿ web ç™»å½•æ˜¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç”¨ Cookie+Session çš„æ–¹å¼ï¼Œè¿™ç§ä¾èµ–äºæœåŠ¡å™¨æœ¬åœ°å†…å­˜ï¼Œå¾®æœåŠ¡ä¸­ï¼Œæ˜¾ç„¶ä¸åˆé€‚ã€‚")]),s._v(" "),t("p",[s._v("å¸¸è§çš„é‰´æƒæ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š")]),s._v(" "),t("h2",{attrs:{id:"ç”¨æˆ·åå’Œå¯†ç "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨æˆ·åå’Œå¯†ç "}},[s._v("#")]),s._v(" ç”¨æˆ·åå’Œå¯†ç ")]),s._v(" "),t("p",[s._v("æ˜¯æœ€ä¼ ç»Ÿå’Œå¸¸è§çš„é‰´æƒæ–¹å¼ï¼Œç”¨æˆ·é€šè¿‡è¾“å…¥é¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œéœ€è¦æ³¨æ„å¯†ç çš„å­˜å‚¨å’Œä¼ è¾“å®‰å…¨ï¼Œå¦‚ä½¿ç”¨åŠ ç›å“ˆå¸Œå­˜å‚¨å’ŒHTTPS ä¼ è¾“ã€‚")]),s._v(" "),t("h2",{attrs:{id:"å¤šå› ç´ è®¤è¯-mfa"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¤šå› ç´ è®¤è¯-mfa"}},[s._v("#")]),s._v(" å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰")]),s._v(" "),t("p",[s._v("è¿™æ˜¯ä¸€ç§å¢å¼ºå®‰å…¨æ€§çš„æ–¹æ³•ï¼Œé€šè¿‡è¦æ±‚å¤šç§ä¸åŒç±»å‹çš„éªŒè¯å› ç´ æ¥ç¡®è®¤ç”¨æˆ·èº«ä»½ï¼Œå¸¸è§çš„å› ç´ åŒ…æ‹¬ï¼šçŸ¥è¯†å› å­ï¼ˆå¯†ç ï¼‰ã€æ‹¥æœ‰å› å­ï¼ˆæ‰‹æœºéªŒè¯ç ï¼‰ã€ç”Ÿç‰©å› å­ï¼ˆæŒ‡çº¹ã€é¢éƒ¨è¯†åˆ«ï¼‰ã€‚")]),s._v(" "),t("h2",{attrs:{id:"oauth-å¼€æ”¾æˆæƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oauth-å¼€æ”¾æˆæƒ"}},[s._v("#")]),s._v(" OAuthï¼ˆå¼€æ”¾æˆæƒï¼‰")]),s._v(" "),t("p",[s._v("è¿™æ˜¯ä¸€ç§ä¸€ç§æˆæƒåè®®ï¼Œå…è®¸ç¬¬ä¸‰æ–¹åº”ç”¨ä»¥æœ‰é™çš„æƒé™è®¿é—®ç”¨æˆ·èµ„æºï¼Œè€Œæ— éœ€æš´éœ²ç”¨æˆ·çš„å‡­è¯ã€‚å¸¸ç”¨äºç¤¾äº¤ç™»å½•å’ŒAPIè®¿é—®æ§åˆ¶ã€‚")]),s._v(" "),t("h2",{attrs:{id:"jwt-json-web-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt-json-web-token"}},[s._v("#")]),s._v(" "),t("strong",[s._v("JWTï¼ˆJSON Web Tokenï¼‰")])]),s._v(" "),t("p",[s._v("ä¸€ç§åŸºäº JSON çš„å¼€æ”¾æ ‡å‡†ï¼ˆRFC 7519ï¼‰ï¼Œç”¨äºåœ¨å„æ–¹ä¹‹é—´ä¼ é€’å£°æ˜ã€‚JWTåŒ…å«ç”¨æˆ·ä¿¡æ¯å’Œç­¾åï¼Œå¯ç”¨äºé‰´æƒå’Œæˆæƒã€‚æˆ‘ä»¬è¿™æ¬¡ä¹Ÿæ˜¯é‡‡ç”¨çš„è¿™ç§æ–¹å¼è¿›è¡Œçš„é‰´æƒã€‚")]),s._v(" "),t("h1",{attrs:{id:"å¾®æœåŠ¡ä¸­é‰´æƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¾®æœåŠ¡ä¸­é‰´æƒ"}},[s._v("#")]),s._v(" å¾®æœåŠ¡ä¸­é‰´æƒ")]),s._v(" "),t("p",[s._v("å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œé€šå¸¸æœ‰å¤šä¸ªç‹¬ç«‹æœåŠ¡ç»„æˆï¼Œè¿™äº›æœåŠ¡å¯èƒ½éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨æˆ–æ•°æ®ä¸­å¿ƒï¼Œ é‰´æƒæœºåˆ¶éœ€è¦åœ¨"),t("strong",[s._v("åˆ†å¸ƒå¼ç¯å¢ƒ")]),s._v("ä¸­æœ‰æ•ˆè¿ä½œï¼Œç¡®ä¿å„ä¸ªæœåŠ¡èƒ½å®‰å…¨é€šä¿¡ï¼Œä¸”éœ€è¦"),t("strong",[s._v("æœ‰ç»Ÿä¸€è®¤è¯ä¸­å¿ƒ")]),s._v("ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ å¾®æœåŠ¡æ¶æ„å›¾ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/29495295/1715739261815-22a1133b-6628-4c24-b185-7d7758ae44df.png#averageHue=%230d0a08&clientId=u686e1142-8b1c-4&from=drop&id=u415c7047&originHeight=2214&originWidth=4383&originalType=binary&ratio=2&rotation=0&showTitle=true&size=815815&status=done&style=none&taskId=ua47f0299-7ebc-477a-8b00-5d6a1f681d1&title=%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E5%9B%BE%EF%BC%88%E6%9D%A5%E6%BA%90%E4%BA%8E%E7%BD%91%E7%BB%9C%EF%BC%89",alt:"å¾®æœåŠ¡æ¶æ„å›¾ï¼ˆæ¥æºäºç½‘ç»œï¼‰",title:"å¾®æœåŠ¡æ¶æ„å›¾ï¼ˆæ¥æºäºç½‘ç»œï¼‰"}})]),s._v(" "),t("p",[s._v("é€šå¸¸ä¼šæœ‰ä¸€ä¸ªå•ç‹¬çš„å¾®æœåŠ¡æ¥åšè®¤è¯ï¼Œä¹Ÿå°±æ˜¯è®¤è¯æœåŠ¡ï¼Œå¯¹äºå¾®æœåŠ¡ç³»ç»Ÿè€Œè¨€ï¼Œè¯·æ±‚ä¸€èˆ¬åˆ†ä¸º 2 ç§ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("é€šè¿‡ API ç½‘å…³çš„è¯·æ±‚")]),s._v(" "),t("li",[s._v("å¾®æœåŠ¡å†…éƒ¨è¯·æ±‚")])]),s._v(" "),t("p",[s._v("å¯¹äºè¿™ä¸¤ç§è¯·æ±‚ï¼Œéƒ½éœ€è¦è¿›è¡Œé‰´æƒï¼Œä½†æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œ")]),s._v(" "),t("h2",{attrs:{id:"å¾®æœåŠ¡ä¸­å¦‚ä½•åšè®¤è¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¾®æœåŠ¡ä¸­å¦‚ä½•åšè®¤è¯"}},[s._v("#")]),s._v(" å¾®æœåŠ¡ä¸­å¦‚ä½•åšè®¤è¯ï¼Ÿ")]),s._v(" "),t("p",[s._v("å¾®æœåŠ¡ä¸­çš„è®¤è¯æœ€å¤šçš„æ–¹å¼æ˜¯é€šè¿‡ JWT ä»¤ç‰Œçš„æ–¹å¼ï¼Œä½† JWT å®é™…ä¸Šæ˜¯æ— çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯æ²¡æ³•ç¡®å®šç™»å½•çš„ç”¨æˆ·å•¥æ—¶å€™è¿‡æœŸï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¼šéœ€è¦ç»“åˆ Redis æ¥"),t("strong",[s._v("è®¾ç½®çŠ¶æ€")]),s._v("ã€‚")]),s._v(" "),t("p",[s._v("å°†ç”Ÿæˆçš„ JWT å­—ç¬¦ä¸²åœ¨ Redis ä¸Šä¹Ÿä¿å­˜ä¸€ä»½ï¼Œå¹¶è®¾ç½®"),t("strong",[s._v("è¿‡æœŸæ—¶é—´")]),s._v("ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•æ—¶ï¼Œéœ€è¦å…ˆå» Redis ä¸ŠæŸ¥çœ‹ JWT å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨çš„è¯å†å¯¹ JWT å­—ç¬¦ä¸²åšè§£ææ“ä½œï¼Œå¦‚æœèƒ½æˆåŠŸè§£æï¼Œå°±æ²¡é—®é¢˜ï¼Œå¦‚æœä¸èƒ½æˆåŠŸè§£æï¼Œå°±è¯´æ˜ä»¤ç‰Œä¸åˆæ³•ã€‚")]),s._v(" "),t("p",[s._v("è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/29495295/1714977470294-7188463c-1ba2-4898-bbd3-a209be681dd3.jpeg",alt:""}})]),s._v(" "),t("p",[s._v("æˆ‘çš„åšæ³•æ˜¯ï¼Œåœ¨è®¤è¯æœåŠ¡ä¸­ï¼Œæ£€æŸ¥ç”¨æˆ·åå¯†ç çš„æ­£ç¡®æ€§ï¼Œæ­£ç¡®çš„è¯å°±ç”Ÿæˆ JWT å­—ç¬¦ä¸²ï¼ŒåŒæ—¶å†æŠŠæ•°æ®å­˜å…¥åˆ° Redis ä¸Šï¼Œç„¶åè¿”å› token ä¿¡æ¯ã€‚ç™»å½•è¯·æ±‚å…ˆç»è¿‡ç½‘å…³ï¼Œç½‘å…³å†è½¬å‘åˆ°è®¤è¯æœåŠ¡ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„æµç¨‹ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/29495295/1715693179410-8c2247ac-e915-4a15-ab89-c3ddbb49bf3b.jpeg",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"å¾®æœåŠ¡ä¸­å¦‚ä½•åšæˆæƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¾®æœåŠ¡ä¸­å¦‚ä½•åšæˆæƒ"}},[s._v("#")]),s._v(" å¾®æœåŠ¡ä¸­å¦‚ä½•åšæˆæƒï¼Ÿ")]),s._v(" "),t("p",[s._v("æˆæƒæ˜¯è¯·æ±‚åˆ°è¾¾æ¯ä¸ªå¾®æœåŠ¡åï¼Œéœ€è¦å¯¹è¯·æ±‚è¿›è¡Œæƒé™åˆ¤å®šï¼Œçœ‹æ˜¯å¦æœ‰æƒé™è®¿é—®ï¼Œé€šå¸¸ä¸ä¼šæ”¾åœ¨ç½‘å…³ä¸­æ¥åšã€‚è¿˜æ˜¯åœ¨å¾®æœåŠ¡ä¸­è‡ªå·±æ¥åšã€‚")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œè¯·æ±‚ä¸»è¦åˆ†ä¸º 2 ç§ï¼Œå¤–éƒ¨è¯·æ±‚å’Œå†…éƒ¨è¯·æ±‚ï¼Œä¸‹é¢æ˜¯ä¸åŒçš„æˆæƒæ€è·¯ã€‚")]),s._v(" "),t("h3",{attrs:{id:"å¤–éƒ¨è¯·æ±‚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¤–éƒ¨è¯·æ±‚"}},[s._v("#")]),s._v(" å¤–éƒ¨è¯·æ±‚")]),s._v(" "),t("p",[s._v("æˆ‘çš„åšæ³•æ˜¯ï¼šè¯·æ±‚åˆ°è¾¾ç½‘å…³åï¼Œé€šè¿‡å¾®æœåŠ¡çš„"),t("strong",[s._v("è‡ªå®šä¹‰è¯·æ±‚å¤´æ‹¦æˆªå™¨")]),s._v("ï¼ˆå¯ä»¥æ”¾åœ¨å…¬å…±åŒ…ä¸‹é¢ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥å¼•ç”¨ï¼‰ï¼Œé…åˆè‡ªå®šä¹‰æ³¨è§£å’Œ AOPï¼Œæ‹¦æˆªè¯·æ±‚å¤´ï¼Œè·å–ç”¨æˆ·å’Œæƒé™ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œæ¯”å¯¹ï¼Œæœ‰æƒé™åˆ™æ”¾è¡Œï¼Œæ²¡æƒé™åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/jpeg/29495295/1715696091512-4df5f63f-89da-4e45-ba4e-4ed8568710f3.jpeg",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"å†…éƒ¨è¯·æ±‚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†…éƒ¨è¯·æ±‚"}},[s._v("#")]),s._v(" å†…éƒ¨è¯·æ±‚")]),s._v(" "),t("p",[s._v("å¯¹äºå†…éƒ¨çš„è¯·æ±‚æ¥è¯´ï¼Œæ­£å¸¸æ˜¯ä¸éœ€è¦é‰´æƒçš„ï¼Œå†…éƒ¨è¯·æ±‚å¯ä»¥ç›´æ¥å¤„ç†ã€‚é—®é¢˜æ˜¯å¦‚æœä½¿ç”¨äº† OpenFeignï¼Œæ•°æ®éƒ½æ˜¯é€šè¿‡æ¥å£æš´éœ²å‡ºå»çš„ï¼Œä¸é‰´æƒçš„è¯ï¼Œåˆä¼šæ‹…å¿ƒä»å¤–éƒ¨æ¥çš„è¯·æ±‚è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ³¨è§£+AOPï¼Œç„¶ååœ¨å†…éƒ¨è¯·æ±‚è°ƒç”¨çš„æ—¶å€™ï¼Œé¢å¤–åŠ ä¸€ä¸ªå¤´å­—æ®µåŠ ä»¥åŒºåˆ†ã€‚")]),s._v(" "),t("p",[s._v("æˆ‘é‡‡ç”¨çš„æ˜¯è‡ªå®šä¹‰å†…éƒ¨è¯·æ±‚æ³¨è§£ï¼Œç„¶å AOP æ§åˆ¶æ‹¦æˆªã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * å†…éƒ¨è®¤è¯æ³¨è§£\n * \n * @author canghe\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElementType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("METHOD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Retention")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RetentionPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUNTIME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Documented")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InnerAuth")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * æ˜¯å¦æ ¡éªŒç”¨æˆ·ä¿¡æ¯\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("AOP çš„åˆ‡é¢æ§åˆ¶è¯·æ±‚æ˜¯å¦æºå¸¦æœ‰å†…éƒ¨è¯·æ±‚çš„æ ‡è¯†ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * å†…éƒ¨æœåŠ¡è°ƒç”¨éªŒè¯å¤„ç†\n *\n * @author canghe\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Aspect")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InnerAuthAspect")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordered")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Around")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@annotation(innerAuth)"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("innerAround")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProceedingJoinPoint")]),s._v(" point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InnerAuth")]),s._v(" innerAuth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" source "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM_SOURCE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å†…éƒ¨è¯·æ±‚éªŒè¯")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INNER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" source"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InnerAuthException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"æ²¡æœ‰å†…éƒ¨è®¿é—®æƒé™ï¼Œä¸å…è®¸è®¿é—®"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" userid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DETAILS_USER_ID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DETAILS_USERNAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç”¨æˆ·ä¿¡æ¯éªŒè¯")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("innerAuth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InnerAuthException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"æ²¡æœ‰è®¾ç½®ç”¨æˆ·ä¿¡æ¯ï¼Œä¸å…è®¸è®¿é—® "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" point"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("proceed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[s._v("å› ä¸ºä½¿ç”¨çš„æ˜¯ OpenFeignï¼Œè¯·æ±‚é€šè¿‡ OpenFeign è°ƒç”¨ä¹Ÿéœ€è¦é‰´æƒï¼Œæ‰€ä»¥æˆ‘å®ç°äº† feign.RequestInterceptor æ¥å£æ¥å®šä¹‰ä¸€ä¸ª OpenFeign çš„è¯·æ±‚æ‹¦æˆªå™¨ï¼Œåœ¨æ‹¦æˆªå™¨ä¸­ï¼Œç»Ÿä¸€ä¸º OpenFeign è¯·æ±‚è®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯ã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * feign è¯·æ±‚æ‹¦æˆªå™¨\n *\n * @author canghe\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FeignRequestInterceptor")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestInterceptor")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apply")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestTemplate")]),s._v(" requestTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" httpServletRequest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isNotNull")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("httpServletRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" headers "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeaders")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("httpServletRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¼ é€’ç”¨æˆ·ä¿¡æ¯è¯·æ±‚å¤´ï¼Œé˜²æ­¢ä¸¢å¤±")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" userId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" headers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DETAILS_USER_ID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isNotEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                requestTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DETAILS_USER_ID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" userId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" userKey "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" headers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("USER_KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isNotEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userKey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                requestTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("USER_KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" userKey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" userName "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" headers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DETAILS_USERNAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isNotEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                requestTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DETAILS_USERNAME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" userName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" authentication "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" headers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AUTHORIZATION_HEADER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isNotEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("authentication"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                requestTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SecurityConstants")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AUTHORIZATION_HEADER")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" authentication"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é…ç½®å®¢æˆ·ç«¯IP")]),s._v("\n            requestTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"X-Forwarded-For"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IpUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getIpAddr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("h1",{attrs:{id:"æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[s._v("#")]),s._v(" æ€»ç»“")]),s._v(" "),t("p",[s._v("å¾®æœåŠ¡ä¸­çš„é‰´æƒæ˜¯å¾ˆå…³é”®çš„ï¼Œä¹Ÿæ˜¯ç³»ç»Ÿå®‰å…¨å’Œå®Œæ•´æ€§çš„æœ€ä¸ºæ ¸å¿ƒçš„ä¸€æ­¥ï¼Œå¾®æœåŠ¡æ¶æ„é€šè¿‡å…¶ç‹¬ç«‹æ€§ã€æ¨¡å—åŒ–å’Œçµæ´»æ€§ï¼Œä½¿å¾—å¼€å‘ã€éƒ¨ç½²å’Œç»´æŠ¤å¤§å‹å¤æ‚ç³»ç»Ÿå˜å¾—æ›´åŠ é«˜æ•ˆå’Œå¯æ§ã€‚ç„¶è€Œï¼Œè¿™ç§åˆ†å¸ƒå¼ç³»ç»Ÿå¸¦æ¥äº†æ–°çš„å®‰å…¨æŒ‘æˆ˜ï¼Œéœ€è¦åœ¨ç³»ç»Ÿè®¾è®¡ä¸­å……åˆ†è€ƒè™‘å’Œå®ç°æœ‰æ•ˆçš„é‰´æƒæœºåˆ¶ã€‚")]),s._v(" "),t("p",[s._v("ä»¥ä¸Šæ˜¯ä»Šå¤©çš„åˆ†äº«ï¼Œé—å¿˜å¯¹ä½ æœ‰å¸®åŠ©ï¼")])])}),[],!1,null,null,null);t.default=e.exports}}]);